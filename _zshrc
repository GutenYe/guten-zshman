[[ $(id -u) -eq 0 ]] && sudo="" || sudo="sudo"

source "$ZSH/zsh.completion.zsh"

# ¤settings #{{{1
# Smart URLs
autoload -U url-quote-magic
zle -N self-insert url-quote-magic

# Jobs
setopt long_list_jobs

# ¤history
export HISTFILE="$HOME/.zhistory"
export HISTSIZE=10000
export SAVEHIST=10000
setopt append_history
setopt extended_history
# setopt hist_expire_dups_first
# setopt hist_ignore_dups
setopt hist_ignore_space
setopt hist_verify
setopt inc_append_history
# setopt share_history
#}}}1

# ¤ls
dircolors ~/.dir_colors >/dev/null
alias ls="ls --color=auto --group-directories-first --ignore-backups"
alias ll='ls -lh'            # Show human readable.
alias la='ls -lhA'           # Show hidden files.
alias lx='ls -lhXB'          # Sort by extension.
alias lk='ls -lhSr'          # Sort by size, biggest last.
alias lc='ls -lhtcr'         # Sort by and show change time, most recent lasa.
alias lu='ls -lhtur'         # Sort by and show access time, most recent last.
alias lt='ls -lhtr'          # Sort by date, most recent last.
alias lm='ls -lha | more'    # Pipe through 'more'.
alias lr='ls -lhR'           # Recursive ls.
alias sl='ls'                

# ¤cd
setopt auto_cd              # Auto cd to a directory without typing cd.
setopt auto_pushd           # Push the old directory onto the stack on cd.
setopt pushd_ignore_dups    # Don't store duplicates in the stack.
setopt cdable_vars          # Change directory to a path stored in a variable.
setopt auto_name_dirs       # Auto add variable-stored paths to ~ list.
setopt multios              # Write to multiple descriptors.
function mkdcd() {
  mkdir -p "$1"
  cd "$1"
}
function cdll() {
  if [[ -n "$1" ]]; then
    builtin cd "$1"
    ls -lFhA
  else
    ls -lFhA
  fi
}

alias ..='cd ..'
alias ...='cd ../..'
alias ....='cd ../../..'
alias .....='cd ../../../..'
alias cd..='cd ..'
alias cd...='cd ../..'
alias cd....='cd ../../..'
alias cd.....='cd ../../../..'
alias cd-='cd -'
alias -- --='cd -'  # - is used by sudo
function cd~() { cd $HOME/$1 }
function cd/() { cd /$1 }

alias 1='cd -'
alias 2='cd +2'
alias 3='cd +3'
alias 4='cd +4'
alias 5='cd +5'
alias 6='cd +6'
alias 7='cd +7'
alias 8='cd +8'
alias 9='cd +9'

function cd() {
  if   [[ "x$*" == "x..." ]]; then
    cd ../..
  elif [[ "x$*" == "x...." ]]; then
    cd ../../..
  elif [[ "x$*" == "x....." ]]; then
    cd ../../..
  elif [[ "x$*" == "x......" ]]; then
    cd ../../../..
  else
    builtin cd "$@"
  fi
}

function ce(){ cd $G_DEV/$1 }
function ceo(){ cd $G_DEV/one/$1 }
function cet(){ cd $G_DEV/two/$1 }
function ces(){ cd $G_DEV/src/$1 }
function cel(){ cd $G_DEV/learn/$1 }
alias cw="cd $G_DOWN"

# ¤alias
# Global
alias -g L="| less "
alias -g V="| vim -"
alias -g 0null=" &>/dev/null"
alias -g 1null=" 1>/dev/null"
alias -g 2null=" 2>/dev/null"

# General
alias rmr="rm -r"
alias du="du $rc[du_options]"
alias df="df $rc[df_options]"
alias pu="pushd"
alias po="popd"
alias history="fc -l 1"
alias get="curl -L -O"
alias afind="ack -il"
alias type="type -a"
alias ssh="ssh -X"

alias -- -="sudo"
alias -- -e="sudo $EDITOR"
alias -- -rm="sudo rm"
alias -- -rmr="sudo rm -r"
alias -- -mv="sudo mv"
alias     cp="cp"
alias -- -cp="sudo cp"
alias -- -ln="sudo ln"
alias     mkdir="mkdir --parents"
alias -- -mkdir="sudo mkdir --parents"
alias     halt="$sudo halt"
alias     reboot="$sudo reboot"
alias -- -kill="sudo kill"
alias dhdpcd="$sudo dhcpcd"
alias netcfg="$sudo netcfg"
alias pppoe-connect="$sudo pppoe-connect"
alias iotop="$sudo iotop --only"
alias rc.d="$sudo rc.d $rc[rcd_options]"

function mount() {
	case $1 in
		"" ) command mount $rc[mount_options] ;;
		* ) $sudo mount $rc[mount_options] $* ;;
	esac
}

alias umount="$sudo umount"

alias top="htop"
#alias topm="top -o vsize"
#alias topc="top -o cpu"
alias diff="colordiff"
alias make="colormake"

alias rsync2="rsync -azHX --stats --progress -vh --numeric-ids"
alias gr="grep"
alias gri="grep -i"
alias -- -gri="sudo grep -i"
alias esed="sed -r"
alias syncdate="s ntpd -qg"
alias uninstaller="wine /usr/lib/wine/fakedlls/uninstaller.exe"
alias pic="feh --scale-down"

function sync(){
#alias muywank="sudo mount -L uywankRoot /uywank; sudo mount -L uywankBoot /uywank/boot; sudo mount -L uywankUsr /uywank/usr; sudo mount -L uywankHome /uywank/home; sudo mount -L uywankBackup /uywank/backup"

#alias uuywank="sudo umount /uywank/home; sudo umount /uywank/usr; sudo umount /uywank/boot; sudo umount /uywank/backup; sudo umount /uywank"

#alias uywanksync="sudo rsync -avhAHXES --numeric-ids --delete  --exclude-from=$G_A/uywanksync_exclude --files-from=$G_A/uywanksync -r / /uywank"

#alias mywank="sudo mount -L ywankRoot /ywank; sudo mount -L ywankBoot /ywank/boot; sudo mount -L ywankUsr /ywank/usr; sudo mount -L ywankHome /ywank/home"

#alias uywank="sudo umount /ywank/home; sudo umount /ywank/usr; sudo umount /ywank/boot; sudo umount /ywank"
#alias ywanksync="sudo rsync -avhAHXES --numeric-ids --delete --delete-after  --exclude-from=$G_A/uywanksync_exclude --files-from=$G_A/uywanksync -r / /ywank"
}

alias winecn='LANG=zh_CN.UTF-8 wine'

alias thermal="acpi -t;sudo hddtemp /dev/sda"
alias cputhermal="acpi -t"
alias cpufreq="cpufreq-info"
alias off="sleep 2 && xset dpms force off"

function vm(){
	case $1 in
		xp ) qemu-kvm /vm/xp.img -m 256M -vga std -enable-kvm -usb -usbdevice mouse -ctrl-grab $*[2,-1] ;;
		xp2 ) qemu-kvm /vm/xp2.img -m 1G -vga std -enable-kvm -usb -usbdevice mouse -ctrl-grab $*[2,-1] ;;
		ubuntu ) qemu-kvm /vm/ubuntu.img -m 1G -vga vmware -enable-kvm -usb -usbdevice mouse -ctrl-grab $*[2,-1] ;;
	esac
}

function restore.ywank(){
	sudo rsync -azHXE --recursive -vh --del --delete-excluded --numeric-ids /uywank/ywank /ywank
}

# ¤mount 
function mou(){
  case $1 in
    kingall ) mou king; mou kingc ;;
    king ) mount /dev/king /media/king ;;
    kingc ) mount -o uid=1000 /dev/kingc /media/kingc ;;
    camera ) mount /dev/camera /media/camera ;;
    uywank ) mount /dev/uywank /uywank ;;
    * ) echo "wrong arguments" ;;
  esac
}

function umou(){
	case $1 in
		kingall ) umount /media/king; umount /media/kingc ;;
		kingc )  umount /media/kingc ;;
		king )  umount /media/king ;;
    uywank ) umount /uywank ;;
    camera ) umount /media/camera ;;
    * ) echo "wrong arguments" ;;
  esac
}

alias man3="man 3"
alias javascript="java -cp /usr/share/java/js.jar org.mozilla.javascript.tools.shell.Main -opt -1"

alias pyvm2="source /opt/python2/bin/activate"

# taw is testawesome
# taw nil
# 		guten/rc.lua
function taw() {
	configfile="rc.lua"
	if [[ -n $2 ]] then
		configfile=$2
	fi

	killall Xephyr;killall Xephyr;
	Xephyr -ac -br -noreset -fullscreen :1 &
	sleep 2
	DISPLAY=:1.0 awesome --config $configfile
}

alias gree="egrep --exclude .*"

alias ncscan="nc -zvw1"

# ¤shortcuts
alias mp="mplayer"
alias o="xdg-open"
alias r="run"
alias x="extract"

#source "$ZSH/zsh.correct.zsh"
# load plugins
source "$ZSH/lib/zshrc.zsh"

# vim: fdm=marker
